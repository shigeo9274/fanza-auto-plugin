# リライト機能 使用方法

## 概要
リライト機能は、既存の投稿済み記事から品番を抽出し、DMM APIで再検索して新しい情報で投稿を更新する機能です。

## 機能の特徴

### 1. 品番抽出
- 投稿のSlugから品番を自動抽出
- 複数の正規表現パターンに対応
- 品番の妥当性を自動チェック

### 2. DMM API検索
- 抽出された品番でDMM APIを検索
- 最新の商品情報を取得
- 画像や動画のURLも更新

### 3. 投稿更新
- 既存投稿のタイトルと内容を更新
- 新しいアイキャッチ画像を設定
- 投稿設定に基づいてコンテンツを構築

## 使用方法

### ステップ1: DMM API接続確認（推奨）
1. 「リライト」タブを開く
2. 「DMM API接続テスト」ボタンをクリック
3. API接続が正常か確認

### ステップ2: パラメータ確認（推奨）
1. 「パラメータ確認」ボタンをクリック
2. APIパラメータと完全なURLを確認
3. 必要に応じて設定を調整

### ステップ3: 既存投稿の取得
1. 「既存投稿を取得」ボタンをクリック
2. WordPressから公開済みの投稿を取得

### ステップ4: 品番の抽出
1. 「品番を抽出（Slugから）」ボタンをクリック
2. 各投稿のSlugから品番を自動抽出
3. 抽出結果を確認

### ステップ5: テスト実行（推奨）
1. 「テスト実行」ボタンをクリック
2. DMM API検索結果のみ確認（投稿は更新されません）
3. 成功率とエラー内容を確認

### ステップ6: リライトの実行
1. 「リライト実行」ボタンをクリック
2. 確認ダイアログで「はい」を選択
3. 10件ずつのバッチで安全に処理
4. 投稿を自動更新

## 品番抽出パターン

以下のパターンに対応しています：

- `ABC-123` (ハイフン区切り)
- `ABC123` (区切りなし)
- `ABC_123` (アンダースコア区切り)
- `ABCD-1234` (4文字+4数字)
- `ABCDE-12` (5文字+2数字)

## 注意事項

### 1. 品番抽出の精度
- 投稿のSlugから品番を直接取得
- 複数のパターンで検索して精度を向上
- 一般的でない品番は除外

### 2. テスト実行の推奨
- 本格実行前に必ずテスト実行を推奨
- 実際の投稿は更新されず、DMM API検索結果のみ確認
- 成功率とエラーの原因を事前に把握

### 3. API制限
- DMM APIの利用制限に注意
- 10件ずつのバッチで安全に処理
- バッチ間に2秒の待機時間を設定

### 4. 投稿更新
- 既存の投稿内容が更新されます
- 元の内容は失われます
- 実行前にバックアップを推奨

## トラブルシューティング

### 品番が抽出されない場合
1. 投稿のSlugに品番が含まれているか確認
2. 品番の形式が一般的なパターンに合致しているか確認
3. 正規表現パターンを調整

### リライトが失敗する場合
1. DMM APIの設定を確認
2. ネットワーク接続を確認
3. WordPressの権限設定を確認

### エラーログの確認
- コンソール出力でエラー詳細を確認
- ログファイルで詳細な情報を確認

## カスタマイズ

### 品番パターンの追加
`gui_rewrite_tab.py`の`product_code_patterns`に新しいパターンを追加できます。

### 抽出ロジックの調整
`is_valid_product_code`メソッドで品番の妥当性チェックをカスタマイズできます。

## 技術仕様

- **言語**: Python 3.7+
- **GUI**: tkinter
- **API**: DMM Affiliate API
- **データベース**: WordPress REST API
- **非同期処理**: threading

## 更新履歴

- v1.0.0: 初期リリース
  - 基本的なリライト機能
  - 品番抽出機能
  - DMM API連携
